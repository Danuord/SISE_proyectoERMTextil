<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <link rel="stylesheet" href="./css/modules/init-module.css">
    <title>Inicializar TextileFlow</title>
   
</head>
<body>
    <div class="container">
        <h1>TextileFlow ERP</h1>
        <p class="subtitle">ConfiguraciÃ³n inicial - Crear cuentas de prueba</p>

        <div class="button-group">
            <button class="btn-init" id="initBtn">Crear Cuentas de Prueba</button>
            <button class="btn-login" id="loginBtn">Ir a Login</button>
        </div>

        <div class="accounts-list">
            <h3>Cuentas de Prueba Disponibles</h3>
            
            <div class="account-item">
                <div class="account-email">
                    admin@textileflow.com
                    <button class="copy-btn" onclick="copyText('admin@textileflow.com')">Copiar</button>
                </div>
                <div class="account-password">
                    ContraseÃ±a: Admin@123456
                    <button class="copy-btn" onclick="copyText('Admin@123456')">Copiar</button>
                </div>
                <span class="account-role role-admin">Admin</span>
            </div>

            <div class="account-item">
                <div class="account-email">
                    manager@textileflow.com
                    <button class="copy-btn" onclick="copyText('manager@textileflow.com')">Copiar</button>
                </div>
                <div class="account-password">
                    ContraseÃ±a: Manager@123456
                    <button class="copy-btn" onclick="copyText('Manager@123456')">Copiar</button>
                </div>
                <span class="account-role role-manager">Manager</span>
            </div>

            <div class="account-item">
                <div class="account-email">
                    empleado@textileflow.com
                    <button class="copy-btn" onclick="copyText('empleado@textileflow.com')">Copiar</button>
                </div>
                <div class="account-password">
                    ContraseÃ±a: Empleado@123456
                    <button class="copy-btn" onclick="copyText('Empleado@123456')">Copiar</button>
                </div>
                <span class="account-role role-employee">Employee</span>
            </div>
        </div>

        <div id="status" class="status"></div>

        <div class="info-box">
            <strong>InformaciÃ³n:</strong><br>
            â€¢ Haz clic en "Crear Cuentas de Prueba" para inicializar las cuentas en Firebase<br>
            â€¢ Una vez creadas, podrÃ¡s usar cualquiera de las cuentas para iniciar sesiÃ³n<br>
            â€¢ TambiÃ©n puedes crear tu propia cuenta en el formulario de registro<br>
            â€¢ Los datos se guardan en Firebase Emulator (desarrollo)
        </div>
    </div>

    <script type="module">
        import { initializeTestAccounts, getTestAccountsInfo } from '../src/config/seedData.js';

        const initBtn = document.getElementById('initBtn');
        const loginBtn = document.getElementById('loginBtn');
        const statusDiv = document.getElementById('status');

        document.addEventListener('DOMContentLoaded', async () => {
            console.log('ðŸ”„ Inicializando cuentas automÃ¡ticamente...');
            await createAccountsAndShow();
        });

        async function createAccountsAndShow() {
            showStatus('loading', 'ðŸ”„ Verificando cuentas de prueba...');
            initBtn.disabled = true;

            try {
                const result = await initializeTestAccounts();
                
                if (result.success) {
                    showStatus('success', 'Â¡Cuentas de prueba listas!<br><br>Ya puedes ir a <a href="./pages/login.html" style="color: inherit; text-decoration: underline;">Login</a> e iniciar sesiÃ³n.');
                } else {
                    showStatus('error', 'Algunas cuentas pudieron no crearse: ' + (result.error || 'Revisa la consola'));
                }
            } catch (error) {
                showStatus('error', ' Error: ' + error.message);
                console.error('Error detallado:', error);
            }

            initBtn.disabled = false;
        }

        initBtn.addEventListener('click', createAccountsAndShow);

        loginBtn.addEventListener('click', () => {
            window.location.href = './pages/login.html';
        });

        function showStatus(type, message) {
            statusDiv.className = `status show ${type}`;
            statusDiv.innerHTML = message;
        }

        function copyText(text) {
            navigator.clipboard.writeText(text);
            alert('âœ“ Copiado: ' + text);
        }

        console.log('Cuentas de prueba disponibles:');
        console.table(getTestAccountsInfo());
    </script>
</body>
</html>
